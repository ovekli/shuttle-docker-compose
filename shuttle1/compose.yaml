name: shuttle1

services:
  gitlab:
    image: gitlab/gitlab-ce:15.11.12-ce.0
    ports:
      - 192.168.243.3:22:22
    environment:
      GITLAB_OMNIBUS_CONFIG: |
        external_url 'https://gitlab.klinghed.se/'
        gitlab_rails['gitlab_shell_ssh_port'] = 22
        nginx['listen_port'] = 80
        nginx['listen_https'] = false
        nginx['proxy_set_headers'] = { "X-Forwarded-Proto" => "https", "X-Forwarded-Ssl" => "on" }
    volumes:
       - /data/dockerVolumes/gitlab/config:/etc/gitlab
       - /data/dockerVolumes/gitlab/logs:/var/Log/gitlab
       - /data/dockerVolumes/gitlab/data:/var/opt/gitlab   

  nexus3:
    image: sonatype/nexus3:3.45.0
    ports:
      - 8181:8081
      - 5000:5000
      - 5001:5001
    volumes:
      - /data/dockerVolumes/nexus3/nexus-data:/nexus-data

  bind:
    image: sameersbn/bind:latest
    ports:
      - 192.168.243.3:53:53/udp
      - 192.168.243.3:53:53/tcp
      - 10000:10000
    environment:
       ROOT_PASSWORD: qwe123  
    volumes:
      - /data/dockerVolumes/nexus3/nexus-data:/nexus-data  

  ddclient:
    image: ovekli/ddclient:1.0.1
    volumes:
      - /data/dockerVolumes/ddclient/.ssh/:/root/.ssh_keys           

  nginx-proxy:
    image: ovekli/nginx
    ports:
      - 192.168.243.3:443:443
    volumes:
      - /data/dockerVolumes/nginx-proxy-config/conf.d:/etc/nginx/conf.d
      - /data/dockerVolumes/nginx-proxy-ssl/ssl:/etc/nginx/ssl  
    depends_on:
      - gitlab

networks:
  shuttle_network: